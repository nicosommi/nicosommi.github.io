<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.3a19d4cf4da6ef1e7b7f.css">@font-face{font-family:Open Sans Extra Bold;src:url(/fonts/open-sans/OpenSans-ExtraBold.ttf)}@font-face{font-family:Cooper Hewitt;src:url(/fonts/cooper-hewitt/CooperHewitt-Light.otf)}@font-face{font-family:PT Sans;src:url(/fonts/pt-sans/PTN57F.ttf)}code{font-family:Menlo,Monaco,Courier New,monospace;background-color:azure}html,p{line-height:1.8em}body{font-family:PT Sans,Georgia,serif;margin:2%;font-size:14pt}h1{letter-spacing:-1pt;line-height:1.2em;font-family:Open Sans Extra Bold,Lucida Grande,Lucida Sans,Lucida Sans Regular,Lucida Sans Unicode,Geneva,Verdana,sans-serif}h2,h3,h4,h5,h6{letter-spacing:1.3pt;font-family:Cooper Hewitt;text-transform:uppercase}@media only screen and (max-width:480px){html{font-size:100%}}</style><meta name="generator" content="Gatsby 2.13.41"/><title data-react-helmet="true">nicosommi</title><meta data-react-helmet="true" name="description" content="nicosommi blog"/><meta data-react-helmet="true" name="keywords" content="blog, developer, javascript, typescript, docker"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="shortcut icon" href="/icons/icon-48x48.png?v=9e0785e51fabaa4444fb627a2ee8aa39"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=9e0785e51fabaa4444fb627a2ee8aa39"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=9e0785e51fabaa4444fb627a2ee8aa39"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=9e0785e51fabaa4444fb627a2ee8aa39"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=9e0785e51fabaa4444fb627a2ee8aa39"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=9e0785e51fabaa4444fb627a2ee8aa39"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=9e0785e51fabaa4444fb627a2ee8aa39"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=9e0785e51fabaa4444fb627a2ee8aa39"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=9e0785e51fabaa4444fb627a2ee8aa39"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-44929876-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-44929876-1', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      }
      </script><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link as="script" rel="preload" href="/webpack-runtime-76516c08f15ad4312478.js"/><link as="script" rel="preload" href="/app-aed0607795d86c2ac8c7.js"/><link as="script" rel="preload" href="/styles-65d0eb307115056d1679.js"/><link as="script" rel="preload" href="/1-6c67a229c5c0a2384dc8.js"/><link as="script" rel="preload" href="/12-6859b23ec19be475578a.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-8e9a8915edc9c4c6ac14.js"/><link as="fetch" rel="preload" href="/page-data/2014/05/02/debugging-node/page-data.json" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div style="margin-bottom:1.45rem"><div style="margin:0 auto;max-width:960px;padding:1.45rem 1.0875rem"><h1 style="margin:0"><style data-emotion-css="1njsknw">.css-1njsknw{-webkit-text-decoration:none;text-decoration:none;color:black;}.css-1njsknw:hover{color:red;outline:1px solid gray;outline-offset:2px;}.css-1njsknw:focus{outline:1px dashed gray;outline-offset:2px;}.css-1njsknw:visited{color:#666;outline-offset:2px;}</style><a class="css-1njsknw" href="/">nicosommi</a></h1><style data-emotion-css="1phry7t">.css-1phry7t{color:gray;margin:0;}</style><h6 class="css-1phry7t"><span>devops</span></h6><style data-emotion-css="1bnxa12">.css-1bnxa12{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:space-around;-webkit-justify-content:space-around;-ms-flex-pack:space-around;justify-content:space-around;}</style><div class="css-1bnxa12"><style data-emotion-css="4kv0r8">.css-4kv0r8 > a{padding-top:5px;}</style><h3 class="css-4kv0r8"><style data-emotion-css="1njsknw">.css-1njsknw{-webkit-text-decoration:none;text-decoration:none;color:black;}.css-1njsknw:hover{color:red;outline:1px solid gray;outline-offset:2px;}.css-1njsknw:focus{outline:1px dashed gray;outline-offset:2px;}.css-1njsknw:visited{color:#666;outline-offset:2px;}</style><a class="css-1njsknw" href="/posts">posts</a></h3><h3 class="css-4kv0r8"><a class="css-1njsknw" href="/slides">slides</a></h3><h3 class="css-4kv0r8"><a class="css-1njsknw" href="/about">about</a></h3></div></div></div><style data-emotion-css="1vohbo4">.css-1vohbo4{margin:5% 20%;}</style><div class="css-1vohbo4"><h1>Debugging node</h1><div>May 02, 2014</div><div>4<!-- --> min read</div><div><p><style data-emotion-css="1njsknw">.css-1njsknw{-webkit-text-decoration:none;text-decoration:none;color:black;}.css-1njsknw:hover{color:red;outline:1px solid gray;outline-offset:2px;}.css-1njsknw:focus{outline:1px dashed gray;outline-offset:2px;}.css-1njsknw:visited{color:#666;outline-offset:2px;}</style><a class="css-1njsknw" href="/?p=250"><em>Para ver este art√≠culo en espa√±ol click aqu√≠.</em></a></p>
<p>When we write scripts on node.js there is always some things flying around our minds.There is a lot of things to think about. Is simple, but you need to know what are you doing because if you don‚Äôt you can get into a mess quickly. Javascript. npm. The good, the bad and the uggly.</p>
<p>One of the things that scared me the most in this node-hell at my begining was the debug method. Some of us are used to use frequently different kinds of logging utilities, from the built in console object to cool npm packages like debug, ain2, winston, etc. But what about the old well known debug process? Yes! I‚Äôm talking about that one that allow us to watch expressiones in the current context, view the backtrace, and that kind of things.</p>
<p>In my experience I was debugging node when I started to use it, but in a heavy way. Using eclipse. I came from Java so that was familiar for me and the V8 eclipse plugin works great and it‚Äôs easy to use. You just start node with ‚Äìdebug flag and connect the plugin to that port. It‚Äôs a very good alternative. You can also use Chrome browser the same way. But today I‚Äôm working on a lighter environment. Now I use Sublime Text and Gedit. Lose the fear to the console is something that we must do. Many of us learn that from ubuntu, git and such. Lose the fear to the console is actually a key part for a light and easy debug with node.</p>
<p>So easy as the well known debugger on complex IDE but in the console. Some programmers are used to this kind of debugging, but for people that worked mostly with Java, C#, TIBCO and that kind of high level programming languages that is not the common thing and this was my first time debugging through the console for real.</p>
<p>First of all let‚Äôs take a look at the need. This came from real environments in which you have to solve a complexs issues all the time. Console logging sometimes does not give us the flexibility we need and in the time we need to know what is happening. Sometimes is just difficult to reproduce just one execution of some case. Many people can discuss about this and some maybe prefer to just trust in his skills‚Ä¶ I don‚Äôt, I just prefer to not feel that pressure, I just want to know how to debug and detect problems watching the environment and using the tools the language provides for doing that.</p>
<p>Well‚Ä¶ now that we know the benefits, let‚Äôs go deep on how do you do this. It‚Äôs so simple‚Ä¶ like everything in js. We just need to put the <strong>debugger;</strong> sentence in the places that we want, taking care of the asynchrounous nature of most apps on node, of course. Then we just execute the app with the debug argument‚Ä¶.</p>
<p><code>node debug script.js</code></p>
<p>That simple. That leave us in the debug console. Now is easy, but from command line. Command we are use to execute with F8, F10, and all that, now are commands like ‚Äòn‚Äô, ‚Äòs‚Äô, ‚Äòc‚Äô, or ‚Äòrepl‚Äô. Yes, n is for next, s if for step into, c is for continue or run. Repl is for entering to a console to eval.</p>
<p>The command list is obviously on the official documentation here <a href="http://nodejs.org/api/debugger.html" target="_blank" class="css-1njsknw">http://nodejs.org/api/debugger.html</a></p>
<p>As I pre-announced some, the most used are:</p>
<ul>
<li>step in: just with s</li>
<li>step out: writing o</li>
<li>next step: n</li>
<li>pause (just writing that)</li>
<li>watch(‚ÄòvariableName‚Äô) : this will print the variable value on each step</li>
<li>unwatch(‚ÄòvariableName‚Äô) : delete some watch to stop printing it</li>
<li>list(4) : prints the context in a 4 line radious of the code, you can provide some other number</li>
<li>repl : very important it allows as I said before to eval something in the current context like the browser‚Äôs console (we can see but we can‚Äôt modify ). Exit with CTRL+C</li>
</ul>
<p>There is extra ‚Äúproblems‚Äù to people who use gulp or grunt (almost everyone) to execute some previous task before running. But if that is your case you can use for example nodemon with the nodeArgs option like this:</p>
<p><code>nodemon({script: &#x27;./app.js&#x27;, nodeArgs: [&#x27;debug&#x27;]})</code></p>
<p>Another common case: test unit. With debug? Yes. For example if we execute</p>
<p><code>mocha debug test/example.js</code></p>
<p>then we also get the debugger.</p>
<p>Combining mocha and grunt/gulp you can do this currently (also with nodemon):</p>
<p><code>nodemon({script: &#x27;./node_modules/mocha/bin/_mocha&#x27;, nodeArgs: [&#x27;debug&#x27;]});</code></p>
<p>where you put your path to the _mocha (with the underscore, is just a file on the mocha module) file on the script option. And you get your test on debug with your previous tasks configured.</p>
<p>You get a ENOSPC Error?</p>
<p>That‚Äôs because of too many files open (either or you have an editor like Sublime or nodemon is including too much files).</p>
<p>You can solve this by increasing the max<em>user</em>watches with this command</p>
<p><code>sudo sysctl fs.inotify.max_user_watches=20000</code></p>
<p>The correct number depends on your needs. You can see your current by executing this</p>
<p><code>more /proc/sys/fs/inotify/max_user_watches</code></p>
<p>Also remember to execute nodemon with the -i node_modules argument.</p>
<p>So, if you didn‚Äôt do this yet, do it, is easy and very useful. Just do a simple for script and try it by yourself. Is going to make your life easier.</p>
<p>Do you have an idea to improve this article? tell me to nicosommi@gmail.com</p></div><div>nico</div></div><style data-emotion-css="bue21p">.css-bue21p{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;font-size:0.75em;line-height:2em;}</style><div class="css-bue21p"><span>Copyright by nicosommi¬†</span><span aria-label="avocado" role="img" class="css-0">ü•ë</span></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2014/05/02/debugging-node/";window.webpackCompilationHash="88062f546259d5d495e1";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-aed0607795d86c2ac8c7.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-5ce71e5f1241232f25a8.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-8e9a8915edc9c4c6ac14.js"],"component---src-templates-slide-tsx":["/component---src-templates-slide-tsx-eb4eb08273a9127d465a.js"],"component---src-pages-404-js":["/component---src-pages-404-js-9c481e236e8db0b48595.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-14df19517f4c25546396.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-ae97f796c48e30552af4.js"],"component---src-pages-posts-tsx":["/component---src-pages-posts-tsx-c5e6a126ac5a3bbcbc49.js"],"component---src-pages-slides-tsx":["/component---src-pages-slides-tsx-15b40d4333b1f47e6e9c.js"]};/*]]>*/</script><script src="/component---src-templates-post-tsx-8e9a8915edc9c4c6ac14.js" async=""></script><script src="/12-6859b23ec19be475578a.js" async=""></script><script src="/1-6c67a229c5c0a2384dc8.js" async=""></script><script src="/styles-65d0eb307115056d1679.js" async=""></script><script src="/app-aed0607795d86c2ac8c7.js" async=""></script><script src="/webpack-runtime-76516c08f15ad4312478.js" async=""></script></body></html>